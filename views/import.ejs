<%- include('partials/header', { title: 'Import Google Sheet', user, role }) %>

<div class="admin-content-wrapper">

<div class="container-fluid px-3 mt-4">
  <div class="row">
    <div class="col-12">
      <h2 class="mb-4">Importer une feuille Google Sheet</h2>
    </div>
  </div>

  <div class="row">
    <div class="col-12 col-md-8 offset-md-2">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">Configuration de l'import</h5>
        </div>
        <div class="card-body">
          <form method="POST" action="/admin/import">
            <div class="mb-3">
              <label for="sheetId" class="form-label">ID de la feuille Google Sheet</label>
              <input type="text" class="form-control" id="sheetId" name="sheetId" 
                     value="1okI49-rXJ9tXF0Ztbw2_3RVHSkIJGsMNEs95ygOsMYc" required readonly>
              <div class="form-text">L'ID de la feuille Google Sheet à importer</div>
            </div>
            
            <div class="mb-3">
              <label for="range" class="form-label">Plage de cellules</label>
              <input type="text" class="form-control" id="range" name="range" 
                     value="A1:H3000" required readonly>
              <div class="form-text">La plage de cellules à importer (ex: A1:H3000)</div>
            </div>
            
            <div class="alert alert-info">
              <h6 class="alert-heading">Information</h6>
              <p class="mb-0">
                Cette action va importer les données depuis la feuille Google Sheet configurée.
                Les données existantes seront mises à jour.
              </p>
            </div>
            
            <div class="d-flex flex-column flex-sm-row gap-2">
              <button type="submit" class="btn btn-success">
                Lancer l'import
              </button>
              <a href="/admin/catalogues/vue" class="btn btn-primary">
                Voir les catalogues
              </a>
              <a href="/admin/menu" class="btn btn-outline-secondary">
                Retour au menu admin
              </a>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Section d'aide -->
  <div class="row mt-4">
    <div class="col-12 col-md-8 offset-md-2">
      <div class="card">
        <div class="card-header">
          <h5 class="card-title mb-0">Aide</h5>
        </div>
        <div class="card-body">
          <h6>Format attendu de la feuille Google Sheet :</h6>
          <div class="table-responsive">
            <table class="table table-sm table-bordered">
              <thead class="table-dark">
                <tr>
                  <th>Colonne A</th>
                  <th>Colonne B</th>
                  <th>Colonne C</th>
                  <th>Colonne D</th>
                  <th>Colonne E</th>
                  <th>Colonne F</th>
                  <th>Colonne G</th>
                  <th>Colonne H</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>Produit</td>
                  <td>Description</td>
                  <td>Prix</td>
                  <td>Catégorie</td>
                  <td>Disponible</td>
                  <td>Quantité</td>
                  <td>Unité</td>
                  <td>Référence</td>
                </tr>
              </tbody>
            </table>
          </div>
          
          <div class="mt-3">
            <h6>Instructions :</h6>
            <ul>
              <li>La première ligne doit contenir les en-têtes</li>
              <li>Les données commencent à partir de la ligne 2</li>
              <li>Les colonnes vides sont ignorées</li>
              <li>L'import peut prendre quelques minutes selon la taille des données</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

</div>
<%- include('partials/footer') %>
