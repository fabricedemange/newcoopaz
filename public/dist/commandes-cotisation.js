import{i as g,o as s,c as a,a as t,b as c,j as v,t as l,d as b,F as m,l as h,r as d,h as _}from"./chunks/runtime-dom.esm-bundler-CuNObg1-.js";import{_ as y}from"./chunks/BackButton-DzFd1NqY.js";import{g as x}from"./chunks/index-CQL6Akic.js";const N={class:"admin-content-wrapper"},k={class:"container-fluid mt-4"},w={class:"d-flex justify-content-between align-items-center flex-wrap gap-2 mb-4"},F={key:0,class:"alert alert-danger alert-dismissible fade show"},q={key:1,class:"text-center py-5"},C={key:2,class:"alert alert-info text-center"},D={class:"text-muted mb-3"},M={class:"table-responsive"},V={class:"table table-hover"},E={__name:"CotisationHistoriquePage",setup(R){const u=d(!0),i=d(null),r=d([]);function p(n){if(!n)return"—";const e=new Date(n);return isNaN(e.getTime())?n:e.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})}function f(n){const e=parseFloat(n);return Number.isNaN(e)?"—":new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR"}).format(e)}return g(async()=>{u.value=!0,i.value=null;try{const n=await x({limit:200});r.value=n.cotisations||[]}catch(n){i.value=n.message||"Erreur chargement historique",r.value=[]}finally{u.value=!1}}),(n,e)=>(s(),a("div",N,[t("div",k,[t("div",w,[e[1]||(e[1]=t("h2",{class:"mb-0 text-precommandes"},[t("i",{class:"bi bi-coin me-2"}),c("Mon historique de cotisation")],-1)),v(y)]),i.value?(s(),a("div",F,[e[2]||(e[2]=t("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),e[3]||(e[3]=t("strong",null,"Erreur :",-1)),c(" "+l(i.value)+" ",1),t("button",{type:"button",class:"btn-close",onClick:e[0]||(e[0]=o=>i.value=null)})])):b("",!0),u.value?(s(),a("div",q,[...e[4]||(e[4]=[t("div",{class:"spinner-border text-precommandes",role:"status",style:{width:"3rem",height:"3rem"}},null,-1),t("p",{class:"mt-3 text-muted"},"Chargement...",-1)])])):r.value.length===0?(s(),a("div",C,[...e[5]||(e[5]=[t("h4",null,"Aucune cotisation enregistrée",-1),t("p",null,"Vous n'avez pas encore de cotisation mensuelle (5-15 €) enregistrée dans l'historique.",-1)])])):(s(),a(m,{key:3},[t("p",D,l(r.value.length)+" cotisation(s) au total",1),t("div",M,[t("table",V,[e[6]||(e[6]=t("thead",{class:"thead-precommandes"},[t("tr",null,[t("th",null,"Date"),t("th",null,"N° ticket"),t("th",null,"Montant")])],-1)),t("tbody",null,[(s(!0),a(m,null,h(r.value,o=>(s(),a("tr",{key:o.vente_id+"-"+(o.date_cotisation||"")},[t("td",null,l(p(o.date_cotisation)),1),t("td",null,l(o.numero_ticket||"—"),1),t("td",null,[t("strong",null,l(f(o.montant_cotisation)),1)])]))),128))])])])],64))])]))}},B=_(E);B.mount("#commandes-cotisation-app");
