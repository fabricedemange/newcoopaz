import{i as f,o,c as a,a as s,b as r,u as d,t as i,d as h,F as m,k as p,g as y,n as k,h as w}from"./chunks/runtime-dom.esm-bundler-CPobOing.js";import{d as D,c as C}from"./chunks/pinia-8wUEIqj_.js";import{f as E,A}from"./chunks/index-BwM03k9W.js";const H=D("home",{state:()=>({loading:!1,error:null,authRequired:!1,user:null,stats:{paniers:0,commandes:0,catalogues:0},paniersDetails:[],commandesDetails:[],nouveauxCatalogues:[]}),actions:{async loadHomeData(){this.loading=!0,this.error=null,this.authRequired=!1;try{const l=await E();if(l.success)this.user=l.user,this.stats=l.stats,this.paniersDetails=l.paniersDetails??[],this.commandesDetails=l.commandesDetails??[],this.nouveauxCatalogues=l.nouveauxCatalogues??[];else throw new Error(l.error||"Erreur lors du chargement")}catch(l){this.error=l.message,l.code===A&&(this.authRequired=!0),console.error("loadHomeData:",l)}finally{this.loading=!1}}},getters:{hasPaniers:l=>l.paniersDetails.length>0,hasCommandes:l=>l.commandesDetails.length>0,hasNouveauxCatalogues:l=>l.nouveauxCatalogues.length>0}}),N={class:"admin-content-wrapper"},R={class:"container mt-5"},$={key:0,class:"alert alert-warning"},j=["href"],q={key:1,class:"alert alert-danger alert-dismissible fade show"},M={key:2,class:"text-center py-5"},P={class:"row mb-5"},S={class:"col-md-4 mb-3"},V={class:"card border-0 shadow-sm h-100"},B={class:"card-body text-center p-4"},I={class:"display-4 fw-bold mb-2"},z={class:"col-md-4 mb-3"},F={class:"card border-0 shadow-sm h-100"},L={class:"card-body text-center p-4"},T={class:"display-4 fw-bold mb-2"},U={class:"col-md-4 mb-3"},G={class:"card border-0 shadow-sm h-100"},J={class:"card-body text-center p-4"},K={class:"display-4 fw-bold mb-2"},O={class:"row mb-4"},Q={class:"col-12 mb-4"},W={class:"card border-0 shadow-sm"},X={class:"card-body p-0"},Y={key:0,class:"p-4 text-center text-muted"},Z={key:1,class:"table-responsive"},ss={class:"table table-hover mb-0"},ts={class:"badge bg-light text-dark"},es={class:"badge bg-secondary"},os=["href"],as=["href"],ls={class:"col-12 mb-4"},is={class:"card border-0 shadow-sm"},ns={class:"card-body p-0"},ds={key:0,class:"p-4 text-center text-muted"},rs={key:1,class:"table-responsive"},us={class:"table table-hover mb-0"},cs={class:"badge bg-light text-dark"},ms={class:"badge bg-secondary"},bs={class:"badge bg-success"},hs={class:"col-12 mb-4"},ps={class:"card border-0 shadow-sm"},vs={class:"card-body"},gs={key:0,class:"text-center text-muted"},_s={key:1,class:"row g-3"},xs={class:"card h-100 border"},fs={class:"card-body"},ys={class:"d-flex justify-content-between align-items-start mb-2"},ks={class:"card-title mb-0"},ws={key:0,class:"card-text small text-muted mb-3"},Ds={class:"small mb-2"},Cs={class:"small mb-3"},Es=["href"],As={__name:"HomePage",setup(l){const n=H(),g=y(()=>{const u=typeof window<"u"?encodeURIComponent(window.location.href):"";return u?`/login?redirect=${u}`:"/login"});function b(u){if(!u)return null;const t=new Date;t.setHours(0,0,0,0);const e=new Date(u);e.setHours(0,0,0,0);const c=Math.ceil((e-t)/(1e3*60*60*24));if(c>3)return null;const _={0:"Expire aujourd'hui !",1:"Expire demain !",2:"Expire dans 2 jours",3:"Expire dans 3 jours"},x={0:"bg-danger",1:"bg-warning text-dark",2:"bg-info",3:"bg-info"};return{text:_[c]??`Expire dans ${c} jours`,class:x[c]??""}}return f(()=>{n.loadHomeData()}),(u,t)=>(o(),a("div",N,[s("div",R,[t[28]||(t[28]=s("h2",{class:"mb-4"},[s("i",{class:"bi bi-house-door me-2"}),r("Tableau de bord ")],-1)),d(n).authRequired?(o(),a("div",$,[t[1]||(t[1]=s("i",{class:"bi bi-lock me-2"},null,-1)),t[2]||(t[2]=r(" Vous devez vous connecter pour accéder au tableau de bord. ",-1)),s("a",{href:g.value,class:"alert-link ms-2"},"Se connecter",8,j)])):d(n).error?(o(),a("div",q,[t[3]||(t[3]=s("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),r(i(d(n).error)+" ",1),s("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=e=>d(n).error=null)})])):h("",!0),d(n).loading?(o(),a("div",M,[...t[4]||(t[4]=[s("div",{class:"spinner-border text-primary",role:"status",style:{width:"3rem",height:"3rem"}},null,-1),s("p",{class:"mt-3 text-muted"},"Chargement des données...",-1)])])):(o(),a(m,{key:3},[s("div",P,[s("div",S,[s("div",V,[s("div",B,[t[5]||(t[5]=s("div",{class:"mb-3"},[s("i",{class:"bi bi-cart3 fs-1 text-primary"})],-1)),s("h3",I,i(d(n).stats.paniers),1),t[6]||(t[6]=s("p",{class:"text-muted mb-0"},"Paniers en cours",-1))])])]),s("div",z,[s("div",F,[s("div",L,[t[7]||(t[7]=s("div",{class:"mb-3"},[s("i",{class:"bi bi-truck fs-1 text-success"})],-1)),s("h3",T,i(d(n).stats.commandes),1),t[8]||(t[8]=s("p",{class:"text-muted mb-0"},"Commandes en attente",-1))])])]),s("div",U,[s("div",G,[s("div",J,[t[9]||(t[9]=s("div",{class:"mb-3"},[s("i",{class:"bi bi-book fs-1 text-info"})],-1)),s("h3",K,i(d(n).stats.catalogues),1),t[10]||(t[10]=s("p",{class:"text-muted mb-0"},"Catalogues disponibles",-1))])])])]),s("div",O,[s("div",Q,[s("div",W,[t[15]||(t[15]=s("div",{class:"card-header bg-white border-bottom"},[s("h5",{class:"mb-0"},[s("i",{class:"bi bi-cart3 me-2"}),r("Mes paniers en cours")])],-1)),s("div",X,[d(n).hasPaniers?(o(),a("div",Z,[s("table",ss,[t[14]||(t[14]=s("thead",{class:"thead-precommandes"},[s("tr",null,[s("th",null,"ID"),s("th",null,"Catalogue"),s("th",null,"Articles"),s("th",null,"Date d'expiration"),s("th",null,"Actions")])],-1)),s("tbody",null,[(o(!0),a(m,null,p(d(n).paniersDetails,e=>(o(),a("tr",{key:e.id},[s("td",null,[s("span",ts,"#"+i(e.id),1)]),s("td",null,i(e.catalogue_nom),1),s("td",null,[s("span",es,i(e.nb_articles),1)]),s("td",null,[r(i(e.expiration)+" ",1),b(e.expiration_commande)?(o(),a("span",{key:0,class:k(["badge ms-2",b(e.expiration_commande).class])},i(b(e.expiration_commande).text),3)):h("",!0)]),s("td",null,[s("a",{href:`/panier/${e.id}/modifier/vue`,class:"btn btn-sm btn-outline-primary"},[...t[12]||(t[12]=[s("i",{class:"bi bi-pencil me-1"},null,-1),r("Modifier ",-1)])],8,os),s("a",{href:`/catalogues/${e.catalogue_id}/vue`,class:"btn btn-sm btn-outline-secondary ms-1"},[...t[13]||(t[13]=[s("i",{class:"bi bi-eye me-1"},null,-1),r("Voir ",-1)])],8,as)])]))),128))])])])):(o(),a("div",Y,[...t[11]||(t[11]=[s("i",{class:"bi bi-inbox fs-1 mb-3 d-block"},null,-1),s("p",null,"Aucun panier en cours",-1)])]))])])]),s("div",ls,[s("div",is,[t[19]||(t[19]=s("div",{class:"card-header bg-white border-bottom"},[s("h5",{class:"mb-0"},[s("i",{class:"bi bi-truck me-2"}),r("Mes commandes en attente de livraison")])],-1)),s("div",ns,[d(n).hasCommandes?(o(),a("div",rs,[s("table",us,[t[18]||(t[18]=s("thead",{class:"thead-precommandes"},[s("tr",null,[s("th",null,"ID"),s("th",null,"Catalogue"),s("th",null,"Articles"),s("th",null,"Date de livraison"),s("th",null,"Statut")])],-1)),s("tbody",null,[(o(!0),a(m,null,p(d(n).commandesDetails,e=>(o(),a("tr",{key:e.id},[s("td",null,[s("span",cs,"#"+i(e.id),1)]),s("td",null,i(e.catalogue_nom),1),s("td",null,[s("span",ms,i(e.nb_articles),1)]),s("td",null,i(e.livraison),1),s("td",null,[s("span",bs,[t[17]||(t[17]=s("i",{class:"bi bi-check-circle me-1"},null,-1)),r(i(e.statut),1)])])]))),128))])])])):(o(),a("div",ds,[...t[16]||(t[16]=[s("i",{class:"bi bi-inbox fs-1 mb-3 d-block"},null,-1),s("p",null,"Aucune commande en attente",-1)])]))])])]),s("div",hs,[s("div",ps,[t[27]||(t[27]=s("div",{class:"card-header bg-white border-bottom"},[s("h5",{class:"mb-0"},[s("i",{class:"bi bi-star me-2"}),r("Nouveaux catalogues disponibles")])],-1)),s("div",vs,[d(n).hasNouveauxCatalogues?(o(),a("div",_s,[(o(!0),a(m,null,p(d(n).nouveauxCatalogues,e=>(o(),a("div",{key:e.id,class:"col-md-4"},[s("div",xs,[s("div",fs,[s("div",ys,[s("h6",ks,i(e.originalname),1),t[21]||(t[21]=s("span",{class:"badge bg-primary"},"Nouveau",-1))]),e.description?(o(),a("p",ws,i(e.description),1)):h("",!0),s("div",Ds,[t[22]||(t[22]=s("i",{class:"bi bi-calendar-event text-primary me-1"},null,-1)),t[23]||(t[23]=s("strong",null,"Commandes avant le :",-1)),r(" "+i(e.expiration),1)]),s("div",Cs,[t[24]||(t[24]=s("i",{class:"bi bi-truck text-success me-1"},null,-1)),t[25]||(t[25]=s("strong",null,"Livraison le :",-1)),r(" "+i(e.livraison),1)]),s("a",{href:`/catalogues/${e.id}/vue`,class:"btn btn-sm btn-primary w-100"},[...t[26]||(t[26]=[s("i",{class:"bi bi-cart-plus me-1"},null,-1),r("Commander ",-1)])],8,Es)])])]))),128))])):(o(),a("div",gs,[...t[20]||(t[20]=[s("i",{class:"bi bi-inbox fs-1 mb-3 d-block"},null,-1),s("p",null,"Aucun nouveau catalogue",-1)])]))])])])])],64))])]))}},v=w(As);v.use(C());v.mount("#home-app");
