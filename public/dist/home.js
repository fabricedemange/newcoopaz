import{i as f,o,c as a,a as s,b as r,u as d,t as n,d as h,F as m,l as p,g as y,n as k,h as w}from"./chunks/runtime-dom.esm-bundler-CuNObg1-.js";import{d as D,c as C}from"./chunks/pinia-gLxYYWQL.js";import{f as E,A}from"./chunks/index-CLmjs_4-.js";import{_ as H}from"./chunks/_plugin-vue_export-helper-DlAUqK2U.js";const N=D("home",{state:()=>({loading:!1,error:null,authRequired:!1,user:null,stats:{paniers:0,commandes:0,catalogues:0},paniersDetails:[],commandesDetails:[],nouveauxCatalogues:[]}),actions:{async loadHomeData(){this.loading=!0,this.error=null,this.authRequired=!1;try{const l=await E();if(l.success)this.user=l.user,this.stats=l.stats,this.paniersDetails=l.paniersDetails??[],this.commandesDetails=l.commandesDetails??[],this.nouveauxCatalogues=l.nouveauxCatalogues??[];else throw new Error(l.error||"Erreur lors du chargement")}catch(l){this.error=l.message,l.code===A&&(this.authRequired=!0),console.error("loadHomeData:",l)}finally{this.loading=!1}}},getters:{hasPaniers:l=>l.paniersDetails.length>0,hasCommandes:l=>l.commandesDetails.length>0,hasNouveauxCatalogues:l=>l.nouveauxCatalogues.length>0}}),j={class:"admin-content-wrapper home-page"},P={class:"container mt-5"},R={key:0,class:"alert alert-warning"},$=["href"],q={key:1,class:"alert alert-danger alert-dismissible fade show"},M={key:2,class:"text-center py-5"},S={class:"row mb-5"},V={class:"col-md-4 mb-3"},B={href:"/panier/vue",class:"text-decoration-none text-reset d-block h-100 card-link-block"},I={class:"card border-0 shadow-sm h-100"},z={class:"card-body text-center p-4"},F={class:"display-4 fw-bold mb-2"},L={class:"col-md-4 mb-3"},T={href:"/commandes/vue",class:"text-decoration-none text-reset d-block h-100 card-link-block"},U={class:"card border-0 shadow-sm h-100"},G={class:"card-body text-center p-4"},J={class:"display-4 fw-bold mb-2"},K={class:"col-md-4 mb-3"},O={href:"/catalogues/vue",class:"text-decoration-none text-reset d-block h-100 card-link-block"},Q={class:"card border-0 shadow-sm h-100"},W={class:"card-body text-center p-4"},X={class:"display-4 fw-bold mb-2"},Y={class:"row mb-4"},Z={class:"col-12 mb-4"},ss={class:"card border-0 shadow-sm"},ts={class:"card-body p-0"},es={key:0,class:"p-4 text-center text-muted"},os={key:1,class:"table-responsive"},as={class:"table table-hover mb-0"},ls={class:"badge bg-light text-dark"},ns={class:"badge bg-secondary"},is=["href"],ds=["href"],rs={class:"col-12 mb-4"},cs={class:"card border-0 shadow-sm"},us={class:"card-body p-0"},ms={key:0,class:"p-4 text-center text-muted"},bs={key:1,class:"table-responsive"},hs={class:"table table-hover mb-0"},ps={class:"badge bg-light text-dark"},vs={class:"badge bg-secondary"},gs={class:"badge bg-success"},_s={class:"col-12 mb-4"},xs={class:"card border-0 shadow-sm"},fs={class:"card-body"},ys={key:0,class:"text-center text-muted"},ks={key:1,class:"row g-3"},ws={class:"card h-100 border"},Ds={class:"card-body"},Cs={class:"d-flex justify-content-between align-items-start mb-2"},Es={class:"card-title mb-0"},As={key:0,class:"card-text small text-muted mb-3"},Hs={class:"small mb-2"},Ns={class:"small mb-3"},js=["href"],Ps={__name:"HomePage",setup(l){const i=N(),g=y(()=>{const c=typeof window<"u"?encodeURIComponent(window.location.href):"";return c?`/login?redirect=${c}`:"/login"});function b(c){if(!c)return null;const t=new Date;t.setHours(0,0,0,0);const e=new Date(c);e.setHours(0,0,0,0);const u=Math.ceil((e-t)/(1e3*60*60*24));if(u>3)return null;const _={0:"Expire aujourd'hui !",1:"Expire demain !",2:"Expire dans 2 jours",3:"Expire dans 3 jours"},x={0:"bg-danger",1:"bg-warning text-dark",2:"bg-info",3:"bg-info"};return{text:_[u]??`Expire dans ${u} jours`,class:x[u]??""}}return f(()=>{i.loadHomeData()}),(c,t)=>(o(),a("div",j,[s("div",P,[t[28]||(t[28]=s("div",{class:"d-flex justify-content-between align-items-center flex-wrap gap-2 mb-4"},[s("h2",{class:"mb-0"},[s("i",{class:"bi bi-house-door me-2"}),r("Tableau de bord ")])],-1)),d(i).authRequired?(o(),a("div",R,[t[1]||(t[1]=s("i",{class:"bi bi-lock me-2"},null,-1)),t[2]||(t[2]=r(" Vous devez vous connecter pour accéder au tableau de bord. ",-1)),s("a",{href:g.value,class:"alert-link ms-2"},"Se connecter",8,$)])):d(i).error?(o(),a("div",q,[t[3]||(t[3]=s("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),r(n(d(i).error)+" ",1),s("button",{type:"button",class:"btn-close",onClick:t[0]||(t[0]=e=>d(i).error=null)})])):h("",!0),d(i).loading?(o(),a("div",M,[...t[4]||(t[4]=[s("div",{class:"spinner-border text-primary",role:"status",style:{width:"3rem",height:"3rem"}},null,-1),s("p",{class:"mt-3 text-muted"},"Chargement des données...",-1)])])):(o(),a(m,{key:3},[s("div",S,[s("div",V,[s("a",B,[s("div",I,[s("div",z,[t[5]||(t[5]=s("div",{class:"mb-3"},[s("i",{class:"bi bi-cart3 fs-1 text-primary"})],-1)),s("h3",F,n(d(i).stats.paniers),1),t[6]||(t[6]=s("p",{class:"text-muted mb-0"},"Paniers en cours",-1))])])])]),s("div",L,[s("a",T,[s("div",U,[s("div",G,[t[7]||(t[7]=s("div",{class:"mb-3"},[s("i",{class:"bi bi-truck fs-1 text-success"})],-1)),s("h3",J,n(d(i).stats.commandes),1),t[8]||(t[8]=s("p",{class:"text-muted mb-0"},"Commandes en attente",-1))])])])]),s("div",K,[s("a",O,[s("div",Q,[s("div",W,[t[9]||(t[9]=s("div",{class:"mb-3"},[s("i",{class:"bi bi-book fs-1 text-info"})],-1)),s("h3",X,n(d(i).stats.catalogues),1),t[10]||(t[10]=s("p",{class:"text-muted mb-0"},"Catalogues disponibles",-1))])])])])]),s("div",Y,[s("div",Z,[s("div",ss,[t[15]||(t[15]=s("div",{class:"card-header bg-white border-bottom"},[s("h5",{class:"mb-0"},[s("a",{href:"/panier/vue",class:"text-decoration-none text-dark"},[s("i",{class:"bi bi-cart3 me-2"}),r("Mes paniers en cours")])])],-1)),s("div",ts,[d(i).hasPaniers?(o(),a("div",os,[s("table",as,[t[14]||(t[14]=s("thead",{class:"thead-precommandes"},[s("tr",null,[s("th",null,"ID"),s("th",null,"Catalogue"),s("th",null,"Articles"),s("th",null,"Date d'expiration"),s("th",null,"Actions")])],-1)),s("tbody",null,[(o(!0),a(m,null,p(d(i).paniersDetails,e=>(o(),a("tr",{key:e.id},[s("td",null,[s("span",ls,"#"+n(e.id),1)]),s("td",null,n(e.catalogue_nom),1),s("td",null,[s("span",ns,n(e.nb_articles),1)]),s("td",null,[r(n(e.expiration)+" ",1),b(e.expiration_commande)?(o(),a("span",{key:0,class:k(["badge ms-2",b(e.expiration_commande).class])},n(b(e.expiration_commande).text),3)):h("",!0)]),s("td",null,[s("a",{href:`/panier/${e.id}/modifier/vue`,class:"btn btn-sm btn-outline-primary"},[...t[12]||(t[12]=[s("i",{class:"bi bi-pencil me-1"},null,-1),r("Modifier ",-1)])],8,is),s("a",{href:`/catalogues/${e.catalogue_id}/vue`,class:"btn btn-sm btn-outline-secondary ms-1"},[...t[13]||(t[13]=[s("i",{class:"bi bi-eye me-1"},null,-1),r("Voir ",-1)])],8,ds)])]))),128))])])])):(o(),a("div",es,[...t[11]||(t[11]=[s("i",{class:"bi bi-inbox fs-1 mb-3 d-block"},null,-1),s("p",null,"Aucun panier en cours",-1)])]))])])]),s("div",rs,[s("div",cs,[t[19]||(t[19]=s("div",{class:"card-header bg-white border-bottom"},[s("h5",{class:"mb-0"},[s("a",{href:"/commandes/vue",class:"text-decoration-none text-dark"},[s("i",{class:"bi bi-truck me-2"}),r("Mes commandes en attente de livraison")])])],-1)),s("div",us,[d(i).hasCommandes?(o(),a("div",bs,[s("table",hs,[t[18]||(t[18]=s("thead",{class:"thead-precommandes"},[s("tr",null,[s("th",null,"ID"),s("th",null,"Catalogue"),s("th",null,"Articles"),s("th",null,"Date de livraison"),s("th",null,"Statut")])],-1)),s("tbody",null,[(o(!0),a(m,null,p(d(i).commandesDetails,e=>(o(),a("tr",{key:e.id},[s("td",null,[s("span",ps,"#"+n(e.id),1)]),s("td",null,n(e.catalogue_nom),1),s("td",null,[s("span",vs,n(e.nb_articles),1)]),s("td",null,n(e.livraison),1),s("td",null,[s("span",gs,[t[17]||(t[17]=s("i",{class:"bi bi-check-circle me-1"},null,-1)),r(n(e.statut),1)])])]))),128))])])])):(o(),a("div",ms,[...t[16]||(t[16]=[s("i",{class:"bi bi-inbox fs-1 mb-3 d-block"},null,-1),s("p",null,"Aucune commande en attente",-1)])]))])])]),s("div",_s,[s("div",xs,[t[27]||(t[27]=s("div",{class:"card-header bg-white border-bottom"},[s("h5",{class:"mb-0"},[s("a",{href:"/catalogues/vue",class:"text-decoration-none text-dark"},[s("i",{class:"bi bi-star me-2"}),r("Nouveaux catalogues disponibles")])])],-1)),s("div",fs,[d(i).hasNouveauxCatalogues?(o(),a("div",ks,[(o(!0),a(m,null,p(d(i).nouveauxCatalogues,e=>(o(),a("div",{key:e.id,class:"col-md-4"},[s("div",ws,[s("div",Ds,[s("div",Cs,[s("h6",Es,n(e.originalname),1),t[21]||(t[21]=s("span",{class:"badge bg-primary"},"Nouveau",-1))]),e.description?(o(),a("p",As,n(e.description),1)):h("",!0),s("div",Hs,[t[22]||(t[22]=s("i",{class:"bi bi-calendar-event text-primary me-1"},null,-1)),t[23]||(t[23]=s("strong",null,"Commandes avant le :",-1)),r(" "+n(e.expiration),1)]),s("div",Ns,[t[24]||(t[24]=s("i",{class:"bi bi-truck text-success me-1"},null,-1)),t[25]||(t[25]=s("strong",null,"Livraison le :",-1)),r(" "+n(e.livraison),1)]),s("a",{href:`/catalogues/${e.id}/vue`,class:"btn btn-sm btn-primary w-100"},[...t[26]||(t[26]=[s("i",{class:"bi bi-cart-plus me-1"},null,-1),r("Commander ",-1)])],8,js)])])]))),128))])):(o(),a("div",ys,[...t[20]||(t[20]=[s("i",{class:"bi bi-inbox fs-1 mb-3 d-block"},null,-1),s("p",null,"Aucun nouveau catalogue",-1)])]))])])])])],64))])]))}},Rs=H(Ps,[["__scopeId","data-v-b22410f2"]]),v=w(Rs);v.use(C());v.mount("#home-app");
