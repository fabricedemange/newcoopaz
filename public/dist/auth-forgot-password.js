import{o,c as r,a as e,b as m,t as f,d as c,w as _,e as y,v as g,r as l,g as w,h}from"./chunks/runtime-dom.esm-bundler-CYnru-If.js";const x={class:"container-fluid px-3 mt-4"},k={class:"row justify-content-center"},V={class:"col-12 col-sm-8 col-md-6 col-lg-4"},S={class:"card"},T={class:"card-body"},E={key:0,class:"alert alert-success"},N={key:1,class:"alert alert-danger"},P=["value"],j={class:"mb-3"},B={class:"d-grid gap-2"},C=["disabled"],M={key:0,class:"spinner-border spinner-border-sm me-1"},R={__name:"ForgotPasswordPage",setup(z){const d=l(""),a=l(""),i=l(""),v=l(!1),n=l(!1),p=w(()=>window.CSRF_TOKEN||"");async function b(){a.value="",i.value="",n.value=!0;try{const u=new URLSearchParams({email:d.value,_csrf:p.value}),t=await(await fetch("/forgot-password",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:u.toString(),credentials:"include"})).json().catch(()=>({}));if(t.success){if(v.value=!0,i.value=t.message||"Vérifiez votre messagerie pour changer le mot de passe.",t.redirect){window.location.href=t.redirect;return}}else a.value=t.error||"Une erreur est survenue."}catch{a.value="Erreur de connexion. Veuillez réessayer."}finally{n.value=!1}}return(u,s)=>(o(),r("div",x,[e("div",k,[e("div",V,[e("div",S,[s[5]||(s[5]=e("div",{class:"card-header text-center"},[e("h2",{class:"card-title mb-0"},"Mot de passe oublié")],-1)),e("div",T,[i.value?(o(),r("div",E,[s[1]||(s[1]=e("i",{class:"bi bi-check-circle me-2"},null,-1)),m(f(i.value),1)])):c("",!0),a.value?(o(),r("div",N,[s[2]||(s[2]=e("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),m(f(a.value),1)])):c("",!0),v.value?c("",!0):(o(),r("form",{key:2,onSubmit:_(b,["prevent"])},[e("input",{type:"hidden",name:"_csrf",value:p.value},null,8,P),e("div",j,[s[3]||(s[3]=e("label",{for:"email",class:"form-label"},"Votre adresse e-mail",-1)),y(e("input",{id:"email","onUpdate:modelValue":s[0]||(s[0]=t=>d.value=t),type:"email",class:"form-control",required:"",autocomplete:"email"},null,512),[[g,d.value]])]),e("div",B,[e("button",{type:"submit",class:"btn btn-primary",disabled:n.value},[n.value?(o(),r("span",M)):c("",!0),s[4]||(s[4]=m(" Envoyer le lien de réinitialisation ",-1))],8,C)])],32))]),s[6]||(s[6]=e("div",{class:"card-footer text-center"},[e("a",{href:"/login",class:"btn btn-link"},"Retour à la connexion")],-1))])])])]))}},U=h(R);U.mount("#auth-forgot-password-app");
