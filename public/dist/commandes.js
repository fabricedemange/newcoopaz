import{i as M,o as l,c as i,a as e,b as d,j as R,u as a,n as k,t as n,d as m,F as h,e as L,v as S,l as y,h as z}from"./chunks/runtime-dom.esm-bundler-CuNObg1-.js";import{d as q,c as B}from"./chunks/pinia-gLxYYWQL.js";import{s as O,b as j,r as U,c as H,d as K,e as Q,A as G}from"./chunks/index-CY5spq3H.js";import{_ as J}from"./chunks/BackButton-DzFd1NqY.js";import{_ as W}from"./chunks/_plugin-vue_export-helper-DlAUqK2U.js";const X=q("commandes",{state:()=>({loading:!1,error:null,authRequired:!1,commandes:[],ventes:[],activeTab:"catalogues",searchTerm:"",sortColumn:"created_at",sortDirection:"desc",savingNotes:{},savedNotes:{},errorNotes:{},showDetailModal:!1,selectedVente:null}),getters:{filteredCommandes(r){let o=[...r.commandes];if(r.searchTerm){const g=r.searchTerm.toLowerCase();o=o.filter(c=>c.originalname&&c.originalname.toLowerCase().includes(g)||c.catalog_description&&c.catalog_description.toLowerCase().includes(g)||c.note&&c.note.toLowerCase().includes(g)||String(c.id).includes(g))}return o},sortedCommandes(r){let o=[...r.commandes||[]];if(r.searchTerm){const _=r.searchTerm.toLowerCase();o=o.filter(u=>u.originalname&&u.originalname.toLowerCase().includes(_)||u.catalog_description&&u.catalog_description.toLowerCase().includes(_)||u.note&&u.note.toLowerCase().includes(_)||String(u.id).includes(_))}const g=r.sortColumn,c=r.sortDirection;return o.sort((_,u)=>{let p,f;switch(g){case"id":p=_.id,f=u.id;break;case"catalogue":p=(_.originalname||"").toLowerCase(),f=(u.originalname||"").toLowerCase();break;case"expiration_date":p=_.expiration_date?new Date(_.expiration_date).getTime():0,f=u.expiration_date?new Date(u.expiration_date).getTime():0;break;case"date_livraison":p=_.date_livraison?new Date(_.date_livraison).getTime():0,f=u.date_livraison?new Date(u.date_livraison).getTime():0;break;case"created_at":p=_.created_at?new Date(_.created_at).getTime():0,f=u.created_at?new Date(u.created_at).getTime():0;break;default:return 0}if(typeof p=="string"){const b=p.localeCompare(f);return c==="asc"?b:-b}return c==="asc"?p>f?1:p<f?-1:0:p<f?1:p>f?-1:0})},sortIcon(r){return o=>r.sortColumn!==o?"arrow-down-up":r.sortDirection==="asc"?"arrow-up":"arrow-down"}},actions:{async loadAll(){this.loading=!0,this.error=null,this.authRequired=!1;try{const[r,o]=await Promise.all([K(),Q()]);r.success&&(this.commandes=r.commandes||[]),o.success&&(this.ventes=o.ventes||[])}catch(r){this.error=r.message,r.code===G&&(this.authRequired=!0),console.error("commandes loadAll:",r)}finally{this.loading=!1}},setActiveTab(r){this.activeTab=r},setSearchTerm(r){this.searchTerm=r},sortBy(r){this.sortColumn===r?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortColumn=r,this.sortDirection="asc")},async saveNote(r,o,g){this.savingNotes[r]=!0,delete this.savedNotes[r],delete this.errorNotes[r];try{await H(r,o,g);const c=this.commandes.find(_=>_.id===r);c&&(c.note=o),this.savedNotes[r]=!0,setTimeout(()=>{delete this.savedNotes[r]},2e3)}catch(c){this.errorNotes[r]=!0,setTimeout(()=>delete this.errorNotes[r],3e3),console.error("saveNote:",c)}finally{delete this.savingNotes[r]}},async reopenCommande(r,o){await U(r,o),typeof window<"u"&&window.location.reload()},async loadVenteDetail(r){try{const o=await j(r);if(o.success)this.selectedVente=o,this.showDetailModal=!0;else throw new Error(o.error||"Erreur chargement détail")}catch(o){console.error("loadVenteDetail:",o),typeof window<"u"&&alert("Erreur : "+o.message)}},closeDetailModal(){this.showDetailModal=!1,this.selectedVente=null},async sendTicketPDF(r){try{const o=await O(r);if(o.success&&typeof window<"u")alert("Email envoyé avec succès.");else throw new Error(o.error||"Erreur envoi")}catch(o){console.error("sendTicketPDF:",o),typeof window<"u"&&alert("Erreur : "+o.message)}}}}),Y={class:"admin-content-wrapper"},Z={class:"container-fluid mt-4"},I={class:"row mb-4"},ee={class:"col-12"},te={class:"d-flex justify-content-between align-items-center flex-wrap gap-2 mb-4"},se={class:"nav nav-tabs mb-4",role:"tablist"},oe={class:"nav-item",role:"presentation"},ne={class:"nav-item",role:"presentation"},le={key:0,class:"alert alert-danger alert-dismissible fade show"},ie={key:0,class:"text-center py-5"},ae={key:1,class:"alert alert-info text-center"},re={class:"row mb-3"},de={class:"col-md-6"},ce={class:"input-group"},ue={class:"col-md-6 text-end"},me={class:"text-muted"},_e={key:0,class:"alert alert-warning text-center"},be={class:"d-none d-md-block"},pe={class:"table-responsive"},ve={class:"table table-hover"},he={class:"thead-precommandes"},fe=["onClick"],ge={class:"text-muted"},ye={key:0,class:"badge bg-danger"},ke={class:"mt-2"},xe={class:"ms-2"},we={key:0,class:"text-info"},Ce={key:1,class:"text-success"},De={key:2,class:"text-danger"},Te=["value","onInput"],Ne={class:"d-flex flex-column gap-1"},Ve=["href"],Fe=["onClick"],Ae={key:1,class:"badge bg-secondary"},Ee={class:"d-md-none"},Pe={class:"card-body p-2",style:{"font-size":"0.7rem"}},$e={class:"row g-1 mb-2"},Me={class:"col-6 text-start"},Re={class:"mb-1"},Le={key:0,class:"badge bg-danger",style:{"font-size":"0.6rem"}},Se={class:"mb-1",style:{"font-size":"0.65rem"}},ze={style:{"font-size":"0.65rem"}},qe={class:"col-6 text-end"},Be={class:"mb-1"},Oe={style:{"font-size":"0.65rem"}},je={key:0,class:"mb-2",style:{"font-size":"0.65rem"}},Ue={key:1,class:"text-muted mb-2",style:{"font-size":"0.65rem"}},He={class:"text-center"},Ke=["href"],Qe=["onClick"],Ge={key:0,class:"text-center py-5"},Je={key:1,class:"alert alert-info text-center"},We={class:"row mb-3"},Xe={class:"col-12 text-end"},Ye={class:"text-muted"},Ze={class:"d-none d-md-block"},Ie={class:"table-responsive"},et={class:"table table-hover table-commandes-caisse"},tt={class:"col-ticket"},st={class:"badge bg-secondary"},ot={key:0},nt={key:1,class:"text-muted"},lt={class:"text-primary"},it={key:0,class:"badge bg-secondary"},at={key:1,class:"text-muted"},rt=["onClick"],dt={class:"d-md-none"},ct={class:"card-body"},ut={class:"d-flex justify-content-between align-items-start mb-2"},mt={class:"card-title mb-0"},_t={class:"badge bg-success"},bt={class:"card-text mb-1"},pt={key:0,class:"text-muted"},vt={key:1},ht={class:"text-muted"},ft={class:"text-center mt-2"},gt=["onClick"],yt={key:0,class:"modal show d-block",tabindex:"-1",style:{background:"rgba(0, 0, 0, 0.5)"}},kt={class:"modal-dialog modal-xl"},xt={class:"modal-content"},wt={class:"modal-header card-header-caisse"},Ct={class:"modal-title"},Dt={class:"modal-body"},Tt={class:"row mb-4"},Nt={class:"col-md-6"},Vt={class:"row"},Ft={class:"col-sm-8"},At={class:"col-sm-8"},Et={class:"col-sm-8"},Pt={class:"col-sm-8"},$t={class:"text-primary"},Mt={class:"table-responsive mb-4"},Rt={class:"table table-sm table-bordered"},Lt={key:0,class:"badge bg-info ms-2"},St={key:1,class:"badge bg-warning text-dark ms-2"},zt={class:"text-end"},qt={class:"text-end"},Bt={class:"text-end"},Ot={key:0,class:"text-danger"},jt={key:1,class:"text-muted"},Ut={class:"text-end"},Ht={class:"table-light"},Kt={class:"text-end"},Qt={class:"text-primary"},Gt={key:0},Jt={key:1,class:"table-responsive"},Wt={class:"table table-sm"},Xt={class:"text-end"},Yt={class:"modal-footer"},Zt=["href"],It={__name:"CommandesPage",setup(r){const o=X(),g=[{key:"id",label:"ID"},{key:"catalogue",label:"Catalogue"},{key:"expiration_date",label:"Expiration"},{key:"date_livraison",label:"Livraison"},{key:"created_at",label:"Date commande"}];let c={};function _(b,t){c[b]&&clearTimeout(c[b]),c[b]=setTimeout(()=>{o.saveNote(b,t,typeof window<"u"?window.CSRF_TOKEN:""),delete c[b]},1e3)}function u(b){confirm("Confirmer la réouverture de cette commande en panier ?")&&o.reopenCommande(b,typeof window<"u"?window.CSRF_TOKEN:"")}function p(b){b&&confirm("Envoyer le ticket par email ?")&&o.sendTicketPDF(b)}function f(b){return b?new Date(b).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}return M(()=>{o.loadAll()}),(b,t)=>{var x,w,C,D,T,N,V,F,A,E,P;return l(),i(h,null,[e("div",Y,[e("div",Z,[e("div",I,[e("div",ee,[e("div",te,[t[7]||(t[7]=e("h2",{class:"mb-0"},[e("i",{class:"bi bi-list-check me-2"}),d("Historique de mes achats")],-1)),R(J)]),e("ul",se,[e("li",oe,[e("button",{class:k(["nav-link",{active:a(o).activeTab==="catalogues"}]),type:"button",onClick:t[0]||(t[0]=s=>a(o).setActiveTab("catalogues"))},[t[8]||(t[8]=e("i",{class:"bi bi-book me-2"},null,-1)),d("Précommandes ("+n(a(o).commandes.length)+") ",1)],2)]),e("li",ne,[e("button",{class:k(["nav-link",{active:a(o).activeTab==="caisse"}]),type:"button",onClick:t[1]||(t[1]=s=>a(o).setActiveTab("caisse"))},[t[9]||(t[9]=e("i",{class:"bi bi-cart me-2"},null,-1)),d("Caisse ("+n(a(o).ventes.length)+") ",1)],2)])])])]),a(o).error?(l(),i("div",le,[t[10]||(t[10]=e("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),t[11]||(t[11]=e("strong",null,"Erreur :",-1)),d(" "+n(a(o).error)+" ",1),e("button",{type:"button",class:"btn-close",onClick:t[2]||(t[2]=s=>a(o).error=null)})])):m("",!0),a(o).activeTab==="catalogues"?(l(),i(h,{key:1},[a(o).loading?(l(),i("div",ie,[...t[12]||(t[12]=[e("div",{class:"spinner-border text-primary",role:"status",style:{width:"3rem",height:"3rem"}},null,-1),e("p",{class:"mt-3 text-muted"},"Chargement des commandes...",-1)])])):a(o).commandes.length===0?(l(),i("div",ae,[...t[13]||(t[13]=[e("h4",null,"Aucune commande passée",-1),e("p",null,"Vous n'avez encore passé aucune commande.",-1),e("a",{href:"/catalogues/vue",class:"btn btn-primary"},"Consulter les catalogues",-1)])])):(l(),i(h,{key:2},[e("div",re,[e("div",de,[e("div",ce,[t[14]||(t[14]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-search"})],-1)),L(e("input",{"onUpdate:modelValue":t[3]||(t[3]=s=>a(o).searchTerm=s),type:"text",class:"form-control",placeholder:"Rechercher une commande..."},null,512),[[S,a(o).searchTerm]])])]),e("div",ue,[e("span",me,n(a(o).commandes.length)+" commande(s) au total",1)])]),a(o).sortedCommandes.length===0?(l(),i("div",_e,[...t[15]||(t[15]=[e("p",null,"Aucune commande ne correspond à votre recherche",-1)])])):(l(),i(h,{key:1},[e("div",be,[e("div",pe,[e("table",ve,[e("thead",he,[e("tr",null,[(l(),i(h,null,y(g,s=>e("th",{key:s.key,class:"sortable",style:{cursor:"pointer"},onClick:v=>a(o).sortBy(s.key)},[d(n(s.label)+" ",1),e("i",{class:k(["bi","bi-"+a(o).sortIcon(s.key)+" ms-1"])},null,2)],8,fe)),64)),t[16]||(t[16]=e("th",null,"Description + Note",-1)),t[17]||(t[17]=e("th",null,"Actions",-1))])]),e("tbody",null,[(l(!0),i(h,null,y(a(o).sortedCommandes,s=>(l(),i("tr",{key:s.id},[e("td",null,[e("strong",null,"#"+n(s.id),1)]),e("td",null,[e("strong",null,n(s.originalname),1),t[18]||(t[18]=e("br",null,null,-1)),e("small",ge,"N°"+n(s.catalog_filesID),1)]),e("td",null,[d(n(s.expiration_formatted||""),1),t[19]||(t[19]=e("br",null,null,-1)),s.isExpired?(l(),i("span",ye,"Expiré")):m("",!0)]),e("td",null,n(s.livraison_formatted||""),1),e("td",null,n(s.created_formatted||""),1),e("td",null,[e("div",null,n(s.catalog_description||""),1),e("div",ke,[t[23]||(t[23]=e("small",{class:"text-muted"},"Note (sauvegarde auto)",-1)),e("span",xe,[a(o).savingNotes[s.id]?(l(),i("span",we,[...t[20]||(t[20]=[e("i",{class:"bi bi-arrow-repeat spin"},null,-1),d(" Sauvegarde...",-1)])])):a(o).savedNotes[s.id]?(l(),i("span",Ce,[...t[21]||(t[21]=[e("i",{class:"bi bi-check-circle"},null,-1),d(" Enregistré",-1)])])):a(o).errorNotes[s.id]?(l(),i("span",De,[...t[22]||(t[22]=[e("i",{class:"bi bi-exclamation-circle"},null,-1),d(" Erreur",-1)])])):m("",!0)]),e("textarea",{value:s.note,class:"form-control form-control-sm mt-1",rows:"2",placeholder:"Note personnelle...",onInput:v=>_(s.id,v.target.value)},null,40,Te)])]),e("td",null,[e("div",Ne,[e("a",{href:`/commandes/${s.id}/vue`,class:"btn btn-info btn-sm"},[...t[24]||(t[24]=[e("i",{class:"bi bi-eye"},null,-1),d(" Voir détails",-1)])],8,Ve),s.modifiable?(l(),i("button",{key:0,class:"btn btn-warning btn-sm",onClick:v=>u(s.id)},[...t[25]||(t[25]=[e("i",{class:"bi bi-arrow-counterclockwise"},null,-1),d(" Repasser en panier ",-1)])],8,Fe)):(l(),i("span",Ae,"Non modifiable"))])])]))),128))])])]),t[26]||(t[26]=e("div",{class:"alert alert-secondary mt-3"},[e("strong",null,"Non modifiable"),d(" – Un catalogue associé à une commande peut être expiré ou le référent a choisi de le rendre non modifiable. ")],-1))]),e("div",Ee,[(l(!0),i(h,null,y(a(o).sortedCommandes,s=>(l(),i("div",{key:"m-"+s.id,class:"card mb-2 shadow-sm"},[e("div",Pe,[e("div",$e,[e("div",Me,[e("div",Re,[e("strong",null,"Cde #"+n(s.id),1),d(" par "+n(s.username||"Utilisateur"),1)]),s.isExpired?(l(),i("span",Le,"Expiré")):m("",!0),e("div",Se,[d(n(s.nb_produits||0)+" produits • ",1),e("strong",null,n((s.montant_total||0).toFixed(2))+" €",1)]),e("div",ze,[t[27]||(t[27]=d("Faite le ",-1)),e("strong",null,n(s.created_formatted||"-"),1)])]),e("div",qe,[e("div",Be,[e("strong",null,"Cat #"+n(s.catalog_filesID),1),d(", "+n(s.originalname),1)]),e("div",Oe,[t[28]||(t[28]=d("Expir le ",-1)),e("strong",null,n(s.expiration_formatted||"-"),1),t[29]||(t[29]=d(", livrée le ",-1)),e("strong",null,n(s.livraison_formatted||"-"),1)])])]),s.note?(l(),i("div",je,[e("em",null,"Note: "+n(s.note),1)])):m("",!0),s.catalog_description?(l(),i("div",Ue,n(s.catalog_description),1)):m("",!0),e("div",He,[e("a",{href:`/commandes/${s.id}/vue`,class:"btn btn-sm btn-info me-1"},"Détails",8,Ke),s.modifiable?(l(),i("button",{key:0,class:"btn btn-sm btn-warning",onClick:v=>u(s.id)},"Panier",8,Qe)):m("",!0)])])]))),128)),t[30]||(t[30]=e("div",{class:"alert alert-secondary"},[e("strong",null,"Non modifiable"),d(" – Catalogue expiré ou verrouillé par le référent.")],-1))])],64))],64))],64)):m("",!0),a(o).activeTab==="caisse"?(l(),i(h,{key:2},[a(o).loading?(l(),i("div",Ge,[...t[31]||(t[31]=[e("div",{class:"spinner-border text-primary",role:"status",style:{width:"3rem",height:"3rem"}},null,-1),e("p",{class:"mt-3 text-muted"},"Chargement des achats en caisse...",-1)])])):a(o).ventes.length===0?(l(),i("div",Je,[...t[32]||(t[32]=[e("h4",null,"Aucun achat en caisse",-1),e("p",null,"Vous n'avez encore fait aucun achat en caisse.",-1),e("a",{href:"/caisse",class:"btn btn-primary"},"Aller à la caisse",-1)])])):(l(),i(h,{key:2},[e("div",We,[e("div",Xe,[e("span",Ye,n(a(o).ventes.length)+" achat(s) en caisse",1)])]),e("div",Ze,[e("div",Ie,[e("table",et,[t[34]||(t[34]=e("thead",{class:"thead-precommandes"},[e("tr",null,[e("th",{class:"col-ticket"},"N° Ticket"),e("th",null,"Client"),e("th",null,"Produits"),e("th",null,"Montant"),e("th",null,"Mode paiement"),e("th",null,"Date"),e("th",null,"PréCde"),e("th",null,"Actions")])],-1)),e("tbody",null,[(l(!0),i(h,null,y(a(o).ventes,s=>(l(),i("tr",{key:s.id},[e("td",tt,[e("strong",null,n(s.numero_ticket),1)]),e("td",null,n(s.nom_client||"Anonyme"),1),e("td",null,[e("span",st,n(s.nb_produits)+" article(s)",1),s.produits_preview?(l(),i("br",ot)):m("",!0),s.produits_preview?(l(),i("small",nt,n((s.produits_preview||"").slice(0,50))+n((s.produits_preview||"").length>50?"...":""),1)):m("",!0)]),e("td",null,[e("strong",lt,n(parseFloat(s.montant_ttc).toFixed(2))+" €",1)]),e("td",null,n(s.mode_paiement||"N/A"),1),e("td",null,n(s.created_formatted),1),e("td",null,[s.avec_precommandes?(l(),i("span",it,"Oui")):(l(),i("span",at,"—"))]),e("td",null,[e("button",{class:"btn btn-sm btn-info",onClick:v=>a(o).loadVenteDetail(s.id)},[...t[33]||(t[33]=[e("i",{class:"bi bi-eye"},null,-1),d(" Détails",-1)])],8,rt)])]))),128))])])])]),e("div",dt,[(l(!0),i(h,null,y(a(o).ventes,s=>(l(),i("div",{key:"vm-"+s.id,class:"card mb-3 shadow-sm"},[e("div",ct,[e("div",ut,[e("h6",mt,[t[35]||(t[35]=e("i",{class:"bi bi-receipt me-1"},null,-1)),d(n(s.numero_ticket),1)]),e("span",_t,n(parseFloat(s.montant_ttc).toFixed(2))+" €",1)]),e("p",bt,[t[36]||(t[36]=e("strong",null,"Client:",-1)),d(" "+n(s.nom_client||"Anonyme"),1),t[37]||(t[37]=e("br",null,null,-1)),t[38]||(t[38]=e("strong",null,"Articles:",-1)),d(" "+n(s.nb_produits),1),t[39]||(t[39]=e("br",null,null,-1)),s.produits_preview?(l(),i("small",pt,n((s.produits_preview||"").slice(0,60))+n((s.produits_preview||"").length>60?"...":""),1)):m("",!0),s.produits_preview?(l(),i("br",vt)):m("",!0),t[40]||(t[40]=e("strong",null,"Paiement:",-1)),d(" "+n(s.mode_paiement||"N/A"),1),t[41]||(t[41]=e("br",null,null,-1)),e("small",ht,n(s.created_formatted),1)]),e("div",ft,[e("button",{class:"btn btn-sm btn-info",onClick:v=>a(o).loadVenteDetail(s.id)},[...t[42]||(t[42]=[e("i",{class:"bi bi-eye me-1"},null,-1),d("Voir détails",-1)])],8,gt)])])]))),128))])],64))],64)):m("",!0)])]),a(o).showDetailModal&&a(o).selectedVente?(l(),i("div",yt,[e("div",kt,[e("div",xt,[e("div",wt,[e("h5",Ct,[t[43]||(t[43]=e("i",{class:"bi bi-receipt me-2"},null,-1)),d(" Détail vente "+n((x=a(o).selectedVente.vente)==null?void 0:x.numero_ticket),1)]),e("button",{type:"button",class:"btn-close",onClick:t[4]||(t[4]=s=>a(o).closeDetailModal())})]),e("div",Dt,[e("div",Tt,[e("div",Nt,[t[48]||(t[48]=e("h6",null,"Informations générales",-1)),e("dl",Vt,[t[44]||(t[44]=e("dt",{class:"col-sm-4"},"Date/Heure",-1)),e("dd",Ft,n(f((w=a(o).selectedVente.vente)==null?void 0:w.created_at)),1),t[45]||(t[45]=e("dt",{class:"col-sm-4"},"Caissier",-1)),e("dd",At,n(((C=a(o).selectedVente.vente)==null?void 0:C.caissier_nom)||"N/A"),1),t[46]||(t[46]=e("dt",{class:"col-sm-4"},"Client",-1)),e("dd",Et,n(((D=a(o).selectedVente.vente)==null?void 0:D.client_nom)||((T=a(o).selectedVente.vente)==null?void 0:T.nom_client)||"Anonyme"),1),t[47]||(t[47]=e("dt",{class:"col-sm-4"},"Montant total",-1)),e("dd",Pt,[e("strong",$t,n(parseFloat(((N=a(o).selectedVente.vente)==null?void 0:N.montant_ttc)||0).toFixed(2))+" €",1)])])])]),t[52]||(t[52]=e("h6",null,"Produits vendus",-1)),e("div",Mt,[e("table",Rt,[t[50]||(t[50]=e("thead",{class:"thead-caisse"},[e("tr",null,[e("th",null,"Produit"),e("th",{class:"text-end"},"Quantité"),e("th",{class:"text-end"},"Prix unitaire"),e("th",{class:"text-end"},"Remise"),e("th",{class:"text-end"},"Total")])],-1)),e("tbody",null,[(l(!0),i(h,null,y(a(o).selectedVente.lignes||[],(s,v)=>(l(),i("tr",{key:v,class:k({"table-warning":s.is_avoir,"table-info":s.is_cotisation})},[e("td",null,[d(n(s.nom_produit||s.product_nom_actuel)+" ",1),s.is_cotisation?(l(),i("span",Lt,"Cotisation")):m("",!0),s.is_avoir?(l(),i("span",St,"AVOIR")):m("",!0)]),e("td",zt,n(parseFloat(s.quantite||0).toFixed(3)),1),e("td",qt,n(parseFloat(s.prix_unitaire||0).toFixed(2))+" €",1),e("td",Bt,[(s.remise_pourcent||0)>0?(l(),i("span",Ot," -"+n(s.remise_pourcent)+"% ",1)):(l(),i("span",jt,"—"))]),e("td",Ut,[e("strong",{class:k(s.is_cotisation?"text-info":s.is_avoir?"text-warning":"text-primary")},n(parseFloat(s.montant_ttc||0).toFixed(2))+" € ",3)])],2))),128))]),e("tfoot",Ht,[e("tr",null,[t[49]||(t[49]=e("td",{colspan:"4",class:"text-end"},[e("strong",null,"Total")],-1)),e("td",Kt,[e("strong",Qt,n(parseFloat(((V=a(o).selectedVente.vente)==null?void 0:V.montant_ttc)||0).toFixed(2))+" €",1)])])])])]),((F=a(o).selectedVente.paiements)==null?void 0:F.length)>0?(l(),i("h6",Gt,"Paiements")):m("",!0),((A=a(o).selectedVente.paiements)==null?void 0:A.length)>0?(l(),i("div",Jt,[e("table",Wt,[t[51]||(t[51]=e("thead",{class:"thead-caisse"},[e("tr",null,[e("th",null,"Mode de paiement"),e("th",{class:"text-end"},"Montant")])],-1)),e("tbody",null,[(l(!0),i(h,null,y(a(o).selectedVente.paiements,(s,v)=>(l(),i("tr",{key:v},[e("td",null,n(s.mode_paiement_nom),1),e("td",Xt,[e("strong",null,n(parseFloat(s.montant||0).toFixed(2))+" €",1)])]))),128))])])])):m("",!0)]),e("div",Yt,[e("a",{href:`/api/commandes/${(P=(E=a(o).selectedVente)==null?void 0:E.vente)==null?void 0:P.id}/pdf`,class:"btn btn-outline-caisse",download:"",target:"_blank",rel:"noopener noreferrer"},[...t[53]||(t[53]=[e("i",{class:"bi bi-file-earmark-pdf me-1"},null,-1),d("Télécharger PDF ",-1)])],8,Zt),e("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=s=>{var v;return p((v=a(o).selectedVente.vente)==null?void 0:v.id)})},[...t[54]||(t[54]=[e("i",{class:"bi bi-envelope-fill me-1"},null,-1),d("Envoyer par email ",-1)])]),e("button",{type:"button",class:"btn btn-secondary",onClick:t[6]||(t[6]=s=>a(o).closeDetailModal())},"Fermer")])])])])):m("",!0)],64)}}},es=W(It,[["__scopeId","data-v-3bdbfd8b"]]),$=z(es);$.use(B());$.mount("#commandes-app");
