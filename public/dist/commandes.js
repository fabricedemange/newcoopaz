import{i as M,o as a,c as r,a as e,b as d,u as l,n as k,t as o,d as _,F as v,e as R,v as L,k as y,h as S}from"./chunks/runtime-dom.esm-bundler-C8CGTSXe.js";import{d as z,c as q}from"./chunks/pinia-DIU_KYYh.js";import{s as B,b as O,r as U,c as H,d as K,e as j,A as Q}from"./chunks/index-zlPV8JO4.js";import{_ as G}from"./chunks/_plugin-vue_export-helper-DlAUqK2U.js";const J=z("commandes",{state:()=>({loading:!1,error:null,authRequired:!1,commandes:[],ventes:[],activeTab:"catalogues",searchTerm:"",sortColumn:"created_at",sortDirection:"desc",savingNotes:{},savedNotes:{},errorNotes:{},showDetailModal:!1,selectedVente:null}),getters:{filteredCommandes(i){let n=[...i.commandes];if(i.searchTerm){const f=i.searchTerm.toLowerCase();n=n.filter(u=>u.originalname&&u.originalname.toLowerCase().includes(f)||u.catalog_description&&u.catalog_description.toLowerCase().includes(f)||u.note&&u.note.toLowerCase().includes(f)||String(u.id).includes(f))}return n},sortedCommandes(i){let n=[...i.commandes||[]];if(i.searchTerm){const p=i.searchTerm.toLowerCase();n=n.filter(c=>c.originalname&&c.originalname.toLowerCase().includes(p)||c.catalog_description&&c.catalog_description.toLowerCase().includes(p)||c.note&&c.note.toLowerCase().includes(p)||String(c.id).includes(p))}const f=i.sortColumn,u=i.sortDirection;return n.sort((p,c)=>{let h,g;switch(f){case"id":h=p.id,g=c.id;break;case"catalogue":h=(p.originalname||"").toLowerCase(),g=(c.originalname||"").toLowerCase();break;case"expiration_date":h=p.expiration_date?new Date(p.expiration_date).getTime():0,g=c.expiration_date?new Date(c.expiration_date).getTime():0;break;case"date_livraison":h=p.date_livraison?new Date(p.date_livraison).getTime():0,g=c.date_livraison?new Date(c.date_livraison).getTime():0;break;case"created_at":h=p.created_at?new Date(p.created_at).getTime():0,g=c.created_at?new Date(c.created_at).getTime():0;break;default:return 0}if(typeof h=="string"){const m=h.localeCompare(g);return u==="asc"?m:-m}return u==="asc"?h>g?1:h<g?-1:0:h<g?1:h>g?-1:0})},sortIcon(i){return n=>i.sortColumn!==n?"arrow-down-up":i.sortDirection==="asc"?"arrow-up":"arrow-down"}},actions:{async loadAll(){this.loading=!0,this.error=null,this.authRequired=!1;try{const[i,n]=await Promise.all([K(),j()]);i.success&&(this.commandes=i.commandes||[]),n.success&&(this.ventes=n.ventes||[])}catch(i){this.error=i.message,i.code===Q&&(this.authRequired=!0),console.error("commandes loadAll:",i)}finally{this.loading=!1}},setActiveTab(i){this.activeTab=i},setSearchTerm(i){this.searchTerm=i},sortBy(i){this.sortColumn===i?this.sortDirection=this.sortDirection==="asc"?"desc":"asc":(this.sortColumn=i,this.sortDirection="asc")},async saveNote(i,n,f){this.savingNotes[i]=!0,delete this.savedNotes[i],delete this.errorNotes[i];try{await H(i,n,f);const u=this.commandes.find(p=>p.id===i);u&&(u.note=n),this.savedNotes[i]=!0,setTimeout(()=>{delete this.savedNotes[i]},2e3)}catch(u){this.errorNotes[i]=!0,setTimeout(()=>delete this.errorNotes[i],3e3),console.error("saveNote:",u)}finally{delete this.savingNotes[i]}},async reopenCommande(i,n){await U(i,n),typeof window<"u"&&window.location.reload()},async loadVenteDetail(i){try{const n=await O(i);if(n.success)this.selectedVente=n,this.showDetailModal=!0;else throw new Error(n.error||"Erreur chargement détail")}catch(n){console.error("loadVenteDetail:",n),typeof window<"u"&&alert("Erreur : "+n.message)}},closeDetailModal(){this.showDetailModal=!1,this.selectedVente=null},async sendTicketPDF(i){try{const n=await B(i);if(n.success&&typeof window<"u")alert("Email envoyé avec succès.");else throw new Error(n.error||"Erreur envoi")}catch(n){console.error("sendTicketPDF:",n),typeof window<"u"&&alert("Erreur : "+n.message)}}}}),W={class:"admin-content-wrapper"},X={class:"container-fluid mt-4"},Y={class:"row mb-4"},Z={class:"col-12"},I={class:"nav nav-tabs mb-4",role:"tablist"},ee={class:"nav-item",role:"presentation"},te={class:"nav-item",role:"presentation"},se={key:0,class:"alert alert-danger alert-dismissible fade show"},ne={key:0,class:"text-center py-5"},oe={key:1,class:"alert alert-info text-center"},le={class:"row mb-3"},ie={class:"col-md-6"},ae={class:"input-group"},re={class:"col-md-6 text-end"},de={class:"text-muted"},ue={key:0,class:"alert alert-warning text-center"},ce={class:"d-none d-md-block"},me={class:"table-responsive"},be={class:"table table-hover"},pe={class:"thead-precommandes"},_e=["onClick"],ve={class:"text-muted"},he={key:0,class:"badge bg-danger"},ge={class:"mt-2"},fe={class:"ms-2"},ye={key:0,class:"text-info"},ke={key:1,class:"text-success"},we={key:2,class:"text-danger"},xe=["value","onInput"],Ce={class:"d-flex flex-column gap-1"},De=["href"],Te=["onClick"],Ne={key:1,class:"badge bg-secondary"},Ve={class:"d-md-none"},Fe={class:"card-body p-2",style:{"font-size":"0.7rem"}},Ae={class:"row g-1 mb-2"},Ee={class:"col-6 text-start"},Pe={class:"mb-1"},$e={key:0,class:"badge bg-danger",style:{"font-size":"0.6rem"}},Me={class:"mb-1",style:{"font-size":"0.65rem"}},Re={style:{"font-size":"0.65rem"}},Le={class:"col-6 text-end"},Se={class:"mb-1"},ze={style:{"font-size":"0.65rem"}},qe={key:0,class:"mb-2",style:{"font-size":"0.65rem"}},Be={key:1,class:"text-muted mb-2",style:{"font-size":"0.65rem"}},Oe={class:"text-center"},Ue=["href"],He=["onClick"],Ke={key:0,class:"text-center py-5"},je={key:1,class:"alert alert-info text-center"},Qe={class:"row mb-3"},Ge={class:"col-12 text-end"},Je={class:"text-muted"},We={class:"d-none d-md-block"},Xe={class:"table-responsive"},Ye={class:"table table-hover table-commandes-caisse"},Ze={class:"col-ticket"},Ie={class:"badge bg-secondary"},et={key:0},tt={key:1,class:"text-muted"},st={class:"text-primary"},nt={key:0,class:"badge bg-secondary"},ot={key:1,class:"text-muted"},lt=["onClick"],it={class:"d-md-none"},at={class:"card-body"},rt={class:"d-flex justify-content-between align-items-start mb-2"},dt={class:"card-title mb-0"},ut={class:"badge bg-success"},ct={class:"card-text mb-1"},mt={key:0,class:"text-muted"},bt={key:1},pt={class:"text-muted"},_t={class:"text-center mt-2"},vt=["onClick"],ht={key:0,class:"modal show d-block",tabindex:"-1",style:{background:"rgba(0,0,0,0.5)"}},gt={class:"modal-dialog modal-xl"},ft={class:"modal-content"},yt={class:"modal-header"},kt={class:"modal-title"},wt={class:"modal-body"},xt={class:"row mb-4"},Ct={class:"col-md-6"},Dt={class:"row"},Tt={class:"col-sm-8"},Nt={class:"col-sm-8"},Vt={class:"col-sm-8"},Ft={class:"col-sm-8"},At={class:"text-primary"},Et={class:"table-responsive mb-4"},Pt={class:"table table-sm table-bordered"},$t={key:0,class:"badge bg-warning text-dark ms-2"},Mt={class:"text-end"},Rt={class:"text-end"},Lt={class:"text-end"},St={class:"table-light"},zt={class:"text-end"},qt={class:"text-primary"},Bt={class:"table-responsive"},Ot={class:"table table-sm"},Ut={class:"text-end"},Ht={class:"modal-footer"},Kt=["href"],jt={__name:"CommandesPage",setup(i){const n=J(),f=[{key:"id",label:"ID"},{key:"catalogue",label:"Catalogue"},{key:"expiration_date",label:"Expiration"},{key:"date_livraison",label:"Livraison"},{key:"created_at",label:"Date commande"}];let u={};function p(m,t){u[m]&&clearTimeout(u[m]),u[m]=setTimeout(()=>{n.saveNote(m,t,typeof window<"u"?window.CSRF_TOKEN:""),delete u[m]},1e3)}function c(m){confirm("Confirmer la réouverture de cette commande en panier ?")&&n.reopenCommande(m,typeof window<"u"?window.CSRF_TOKEN:"")}function h(m){m&&confirm("Envoyer le ticket par email ?")&&n.sendTicketPDF(m)}function g(m){return m?new Date(m).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}):"N/A"}return M(()=>{n.loadAll()}),(m,t)=>{var w,x,C,D,T,N,V,F,A,E;return a(),r(v,null,[e("div",W,[e("div",X,[e("button",{class:"btn btn-outline-secondary d-md-none mb-3",onClick:t[0]||(t[0]=s=>{var b,P;return((P=(b=m.$router)==null?void 0:b.back)==null?void 0:P.call(b))||m.history.back()})},[...t[8]||(t[8]=[e("i",{class:"bi bi-arrow-left me-2"},null,-1),d("Retour ",-1)])]),e("div",Y,[e("div",Z,[t[11]||(t[11]=e("h2",{class:"mb-4"},[e("i",{class:"bi bi-list-check me-2"}),d("Historique de mes achats")],-1)),e("ul",I,[e("li",ee,[e("button",{class:k(["nav-link",{active:l(n).activeTab==="catalogues"}]),type:"button",onClick:t[1]||(t[1]=s=>l(n).setActiveTab("catalogues"))},[t[9]||(t[9]=e("i",{class:"bi bi-book me-2"},null,-1)),d("Précommandes ("+o(l(n).commandes.length)+") ",1)],2)]),e("li",te,[e("button",{class:k(["nav-link",{active:l(n).activeTab==="caisse"}]),type:"button",onClick:t[2]||(t[2]=s=>l(n).setActiveTab("caisse"))},[t[10]||(t[10]=e("i",{class:"bi bi-cart me-2"},null,-1)),d("Caisse ("+o(l(n).ventes.length)+") ",1)],2)])])])]),l(n).error?(a(),r("div",se,[t[12]||(t[12]=e("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),t[13]||(t[13]=e("strong",null,"Erreur :",-1)),d(" "+o(l(n).error)+" ",1),e("button",{type:"button",class:"btn-close",onClick:t[3]||(t[3]=s=>l(n).error=null)})])):_("",!0),l(n).activeTab==="catalogues"?(a(),r(v,{key:1},[l(n).loading?(a(),r("div",ne,[...t[14]||(t[14]=[e("div",{class:"spinner-border text-primary",role:"status",style:{width:"3rem",height:"3rem"}},null,-1),e("p",{class:"mt-3 text-muted"},"Chargement des commandes...",-1)])])):l(n).commandes.length===0?(a(),r("div",oe,[...t[15]||(t[15]=[e("h4",null,"Aucune commande passée",-1),e("p",null,"Vous n'avez encore passé aucune commande.",-1),e("a",{href:"/catalogues/vue",class:"btn btn-primary"},"Consulter les catalogues",-1)])])):(a(),r(v,{key:2},[e("div",le,[e("div",ie,[e("div",ae,[t[16]||(t[16]=e("span",{class:"input-group-text"},[e("i",{class:"bi bi-search"})],-1)),R(e("input",{"onUpdate:modelValue":t[4]||(t[4]=s=>l(n).searchTerm=s),type:"text",class:"form-control",placeholder:"Rechercher une commande..."},null,512),[[L,l(n).searchTerm]])])]),e("div",re,[e("span",de,o(l(n).commandes.length)+" commande(s) au total",1)])]),l(n).sortedCommandes.length===0?(a(),r("div",ue,[...t[17]||(t[17]=[e("p",null,"Aucune commande ne correspond à votre recherche",-1)])])):(a(),r(v,{key:1},[e("div",ce,[e("div",me,[e("table",be,[e("thead",pe,[e("tr",null,[(a(),r(v,null,y(f,s=>e("th",{key:s.key,class:"sortable",style:{cursor:"pointer"},onClick:b=>l(n).sortBy(s.key)},[d(o(s.label)+" ",1),e("i",{class:k(["bi","bi-"+l(n).sortIcon(s.key)+" ms-1"])},null,2)],8,_e)),64)),t[18]||(t[18]=e("th",null,"Description + Note",-1)),t[19]||(t[19]=e("th",null,"Actions",-1))])]),e("tbody",null,[(a(!0),r(v,null,y(l(n).sortedCommandes,s=>(a(),r("tr",{key:s.id},[e("td",null,[e("strong",null,"#"+o(s.id),1)]),e("td",null,[e("strong",null,o(s.originalname),1),t[20]||(t[20]=e("br",null,null,-1)),e("small",ve,"N°"+o(s.catalog_filesID),1)]),e("td",null,[d(o(s.expiration_formatted||""),1),t[21]||(t[21]=e("br",null,null,-1)),s.isExpired?(a(),r("span",he,"Expiré")):_("",!0)]),e("td",null,o(s.livraison_formatted||""),1),e("td",null,o(s.created_formatted||""),1),e("td",null,[e("div",null,o(s.catalog_description||""),1),e("div",ge,[t[25]||(t[25]=e("small",{class:"text-muted"},"Note (sauvegarde auto)",-1)),e("span",fe,[l(n).savingNotes[s.id]?(a(),r("span",ye,[...t[22]||(t[22]=[e("i",{class:"bi bi-arrow-repeat spin"},null,-1),d(" Sauvegarde...",-1)])])):l(n).savedNotes[s.id]?(a(),r("span",ke,[...t[23]||(t[23]=[e("i",{class:"bi bi-check-circle"},null,-1),d(" Enregistré",-1)])])):l(n).errorNotes[s.id]?(a(),r("span",we,[...t[24]||(t[24]=[e("i",{class:"bi bi-exclamation-circle"},null,-1),d(" Erreur",-1)])])):_("",!0)]),e("textarea",{value:s.note,class:"form-control form-control-sm mt-1",rows:"2",placeholder:"Note personnelle...",onInput:b=>p(s.id,b.target.value)},null,40,xe)])]),e("td",null,[e("div",Ce,[e("a",{href:`/commandes/${s.id}/vue`,class:"btn btn-info btn-sm"},[...t[26]||(t[26]=[e("i",{class:"bi bi-eye"},null,-1),d(" Voir détails",-1)])],8,De),s.modifiable?(a(),r("button",{key:0,class:"btn btn-warning btn-sm",onClick:b=>c(s.id)},[...t[27]||(t[27]=[e("i",{class:"bi bi-arrow-counterclockwise"},null,-1),d(" Repasser en panier ",-1)])],8,Te)):(a(),r("span",Ne,"Non modifiable"))])])]))),128))])])]),t[28]||(t[28]=e("div",{class:"alert alert-secondary mt-3"},[e("strong",null,"Non modifiable"),d(" – Un catalogue associé à une commande peut être expiré ou le référent a choisi de le rendre non modifiable. ")],-1))]),e("div",Ve,[(a(!0),r(v,null,y(l(n).sortedCommandes,s=>(a(),r("div",{key:"m-"+s.id,class:"card mb-2 shadow-sm"},[e("div",Fe,[e("div",Ae,[e("div",Ee,[e("div",Pe,[e("strong",null,"Cde #"+o(s.id),1),d(" par "+o(s.username||"Utilisateur"),1)]),s.isExpired?(a(),r("span",$e,"Expiré")):_("",!0),e("div",Me,[d(o(s.nb_produits||0)+" produits • ",1),e("strong",null,o((s.montant_total||0).toFixed(2))+" €",1)]),e("div",Re,[t[29]||(t[29]=d("Faite le ",-1)),e("strong",null,o(s.created_formatted||"-"),1)])]),e("div",Le,[e("div",Se,[e("strong",null,"Cat #"+o(s.catalog_filesID),1),d(", "+o(s.originalname),1)]),e("div",ze,[t[30]||(t[30]=d("Expir le ",-1)),e("strong",null,o(s.expiration_formatted||"-"),1),t[31]||(t[31]=d(", livrée le ",-1)),e("strong",null,o(s.livraison_formatted||"-"),1)])])]),s.note?(a(),r("div",qe,[e("em",null,"Note: "+o(s.note),1)])):_("",!0),s.catalog_description?(a(),r("div",Be,o(s.catalog_description),1)):_("",!0),e("div",Oe,[e("a",{href:`/commandes/${s.id}/vue`,class:"btn btn-sm btn-info me-1"},"Détails",8,Ue),s.modifiable?(a(),r("button",{key:0,class:"btn btn-sm btn-warning",onClick:b=>c(s.id)},"Panier",8,He)):_("",!0)])])]))),128)),t[32]||(t[32]=e("div",{class:"alert alert-secondary"},[e("strong",null,"Non modifiable"),d(" – Catalogue expiré ou verrouillé par le référent.")],-1))])],64))],64))],64)):_("",!0),l(n).activeTab==="caisse"?(a(),r(v,{key:2},[l(n).loading?(a(),r("div",Ke,[...t[33]||(t[33]=[e("div",{class:"spinner-border text-primary",role:"status",style:{width:"3rem",height:"3rem"}},null,-1),e("p",{class:"mt-3 text-muted"},"Chargement des achats en caisse...",-1)])])):l(n).ventes.length===0?(a(),r("div",je,[...t[34]||(t[34]=[e("h4",null,"Aucun achat en caisse",-1),e("p",null,"Vous n'avez encore fait aucun achat en caisse.",-1),e("a",{href:"/caisse",class:"btn btn-primary"},"Aller à la caisse",-1)])])):(a(),r(v,{key:2},[e("div",Qe,[e("div",Ge,[e("span",Je,o(l(n).ventes.length)+" achat(s) en caisse",1)])]),e("div",We,[e("div",Xe,[e("table",Ye,[t[36]||(t[36]=e("thead",{class:"thead-precommandes"},[e("tr",null,[e("th",{class:"col-ticket"},"N° Ticket"),e("th",null,"Client"),e("th",null,"Produits"),e("th",null,"Montant"),e("th",null,"Mode paiement"),e("th",null,"Date"),e("th",null,"PréCde"),e("th",null,"Actions")])],-1)),e("tbody",null,[(a(!0),r(v,null,y(l(n).ventes,s=>(a(),r("tr",{key:s.id},[e("td",Ze,[e("strong",null,o(s.numero_ticket),1)]),e("td",null,o(s.nom_client||"Anonyme"),1),e("td",null,[e("span",Ie,o(s.nb_produits)+" article(s)",1),s.produits_preview?(a(),r("br",et)):_("",!0),s.produits_preview?(a(),r("small",tt,o((s.produits_preview||"").slice(0,50))+o((s.produits_preview||"").length>50?"...":""),1)):_("",!0)]),e("td",null,[e("strong",st,o(parseFloat(s.montant_ttc).toFixed(2))+" €",1)]),e("td",null,o(s.mode_paiement||"N/A"),1),e("td",null,o(s.created_formatted),1),e("td",null,[s.avec_precommandes?(a(),r("span",nt,"Oui")):(a(),r("span",ot,"—"))]),e("td",null,[e("button",{class:"btn btn-sm btn-info",onClick:b=>l(n).loadVenteDetail(s.id)},[...t[35]||(t[35]=[e("i",{class:"bi bi-eye"},null,-1),d(" Détails",-1)])],8,lt)])]))),128))])])])]),e("div",it,[(a(!0),r(v,null,y(l(n).ventes,s=>(a(),r("div",{key:"vm-"+s.id,class:"card mb-3 shadow-sm"},[e("div",at,[e("div",rt,[e("h6",dt,[t[37]||(t[37]=e("i",{class:"bi bi-receipt me-1"},null,-1)),d(o(s.numero_ticket),1)]),e("span",ut,o(parseFloat(s.montant_ttc).toFixed(2))+" €",1)]),e("p",ct,[t[38]||(t[38]=e("strong",null,"Client:",-1)),d(" "+o(s.nom_client||"Anonyme"),1),t[39]||(t[39]=e("br",null,null,-1)),t[40]||(t[40]=e("strong",null,"Articles:",-1)),d(" "+o(s.nb_produits),1),t[41]||(t[41]=e("br",null,null,-1)),s.produits_preview?(a(),r("small",mt,o((s.produits_preview||"").slice(0,60))+o((s.produits_preview||"").length>60?"...":""),1)):_("",!0),s.produits_preview?(a(),r("br",bt)):_("",!0),t[42]||(t[42]=e("strong",null,"Paiement:",-1)),d(" "+o(s.mode_paiement||"N/A"),1),t[43]||(t[43]=e("br",null,null,-1)),e("small",pt,o(s.created_formatted),1)]),e("div",_t,[e("button",{class:"btn btn-sm btn-info",onClick:b=>l(n).loadVenteDetail(s.id)},[...t[44]||(t[44]=[e("i",{class:"bi bi-eye me-1"},null,-1),d("Voir détails",-1)])],8,vt)])])]))),128))])],64))],64)):_("",!0)])]),l(n).showDetailModal&&l(n).selectedVente?(a(),r("div",ht,[e("div",gt,[e("div",ft,[e("div",yt,[e("h5",kt,[t[45]||(t[45]=e("i",{class:"bi bi-receipt me-2"},null,-1)),d(" Détail vente "+o((w=l(n).selectedVente.vente)==null?void 0:w.numero_ticket),1)]),e("button",{type:"button",class:"btn-close",onClick:t[5]||(t[5]=s=>l(n).closeDetailModal())})]),e("div",wt,[e("div",xt,[e("div",Ct,[t[50]||(t[50]=e("h6",null,"Informations générales",-1)),e("dl",Dt,[t[46]||(t[46]=e("dt",{class:"col-sm-4"},"Date/Heure",-1)),e("dd",Tt,o(g((x=l(n).selectedVente.vente)==null?void 0:x.created_at)),1),t[47]||(t[47]=e("dt",{class:"col-sm-4"},"Caissier",-1)),e("dd",Nt,o(((C=l(n).selectedVente.vente)==null?void 0:C.caissier_nom)||"N/A"),1),t[48]||(t[48]=e("dt",{class:"col-sm-4"},"Client",-1)),e("dd",Vt,o(((D=l(n).selectedVente.vente)==null?void 0:D.client_nom)||((T=l(n).selectedVente.vente)==null?void 0:T.nom_client)||"Anonyme"),1),t[49]||(t[49]=e("dt",{class:"col-sm-4"},"Montant total",-1)),e("dd",Ft,[e("strong",At,o(parseFloat(((N=l(n).selectedVente.vente)==null?void 0:N.montant_ttc)||0).toFixed(2))+" €",1)])])])]),t[55]||(t[55]=e("h6",null,"Produits vendus",-1)),e("div",Et,[e("table",Pt,[t[52]||(t[52]=e("thead",{class:"thead-precommandes"},[e("tr",null,[e("th",null,"Produit"),e("th",{class:"text-end"},"Quantité"),e("th",{class:"text-end"},"Prix unitaire"),e("th",{class:"text-end"},"Total")])],-1)),e("tbody",null,[(a(!0),r(v,null,y(l(n).selectedVente.lignes||[],(s,b)=>(a(),r("tr",{key:b,class:k({"table-warning":s.is_avoir})},[e("td",null,[d(o(s.nom_produit||s.product_nom_actuel)+" ",1),s.is_avoir?(a(),r("span",$t,"AVOIR")):_("",!0)]),e("td",Mt,o(parseFloat(s.quantite).toFixed(3)),1),e("td",Rt,o(parseFloat(s.prix_unitaire).toFixed(2))+" €",1),e("td",Lt,[e("strong",{class:k(s.is_avoir?"text-warning":"text-primary")},o(parseFloat(s.montant_ttc).toFixed(2))+" €",3)])],2))),128))]),e("tfoot",St,[e("tr",null,[t[51]||(t[51]=e("td",{colspan:"3",class:"text-end"},[e("strong",null,"Total")],-1)),e("td",zt,[e("strong",qt,o(parseFloat(((V=l(n).selectedVente.vente)==null?void 0:V.montant_ttc)||0).toFixed(2))+" €",1)])])])])]),(F=l(n).selectedVente.paiements)!=null&&F.length?(a(),r(v,{key:0},[t[54]||(t[54]=e("h6",null,"Paiements",-1)),e("div",Bt,[e("table",Ot,[t[53]||(t[53]=e("thead",{class:"thead-precommandes"},[e("tr",null,[e("th",null,"Mode"),e("th",{class:"text-end"},"Montant"),e("th",null,"Date")])],-1)),e("tbody",null,[(a(!0),r(v,null,y(l(n).selectedVente.paiements,(s,b)=>(a(),r("tr",{key:b},[e("td",null,o(s.mode_paiement_nom),1),e("td",Ut,[e("strong",null,o(parseFloat(s.montant).toFixed(2))+" €",1)]),e("td",null,o(g(s.date_paiement)),1)]))),128))])])])],64)):_("",!0)]),e("div",Ht,[e("a",{href:`/api/${(E=(A=l(n).selectedVente)==null?void 0:A.vente)==null?void 0:E.id}/pdf`,class:"btn btn-outline-primary",download:"",target:"_blank",rel:"noopener noreferrer"},[...t[56]||(t[56]=[e("i",{class:"bi bi-file-earmark-pdf me-1"},null,-1),d("Télécharger PDF ",-1)])],8,Kt),e("button",{type:"button",class:"btn btn-primary",onClick:t[6]||(t[6]=s=>{var b;return h((b=l(n).selectedVente.vente)==null?void 0:b.id)})},[...t[57]||(t[57]=[e("i",{class:"bi bi-envelope-fill me-1"},null,-1),d("Envoyer par email ",-1)])]),e("button",{type:"button",class:"btn btn-secondary",onClick:t[7]||(t[7]=s=>l(n).closeDetailModal())},"Fermer")])])])])):_("",!0)],64)}}},Qt=G(jt,[["__scopeId","data-v-697329da"]]),$=S(Qt);$.use(q());$.mount("#commandes-app");
