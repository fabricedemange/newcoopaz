import{i as y,o,c as n,F as w,a as e,j as h,b as m,t as v,d as p,w as k,e as b,v as _,r as u,g as A,h as S}from"./chunks/runtime-dom.esm-bundler-CuNObg1-.js";import{c as T}from"./chunks/pinia-gLxYYWQL.js";import{_ as V}from"./chunks/BackButton-DzFd1NqY.js";const I={class:"container-fluid px-3 mt-4"},N={key:0,class:"alert alert-warning"},P={class:"row"},E={class:"col-12"},U={class:"d-flex justify-content-between align-items-center flex-wrap gap-2 mb-4"},$={class:"row"},j={class:"col-12 col-md-8 offset-md-2"},D={key:0,class:"alert alert-danger"},M={class:"card"},R={class:"card-body"},q={key:0,class:"mb-3"},B={class:"form-control-plaintext mb-0"},C={key:1,class:"mb-3"},F={class:"form-control-plaintext mb-0"},L=["value"],O={class:"mb-3"},z={class:"input-group"},K={class:"mb-3"},Q={class:"d-flex gap-2"},G=["disabled"],H={key:0,class:"spinner-border spinner-border-sm me-1"},J=["href"],W={class:"d-flex flex-wrap gap-2 mt-3"},X=["href"],Y={__name:"AdminArticleEditPage",setup(Z){const a=u(null),d=u(null),r=u(""),c=u(!1),l=u({prix:"",unite:""}),f=A(()=>window.CSRF_TOKEN||"");y(()=>{const s=window.INITIAL_DATA||{};a.value=s.article||null,d.value=s.catalogueId||s.catalogue_id||null,r.value=s.error||"",s.article&&(l.value.prix=s.article.prix??"",l.value.unite=s.article.unite??"")});async function g(){if(!(!a.value||!d.value)){r.value="",c.value=!0;try{const s=new URLSearchParams({_csrf:f.value,prix:String(l.value.prix??""),unite:String(l.value.unite??"")}),i=await(await fetch(`/admin/catalogues/${d.value}/articles/${a.value.id}/edit`,{method:"POST",credentials:"include",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:s.toString()})).json().catch(()=>({}));if(i.success&&i.redirect){window.location.href=i.redirect;return}r.value=i.error||"Une erreur est survenue."}catch{r.value="Erreur de connexion. Veuillez réessayer."}finally{c.value=!1}}}return(s,t)=>(o(),n("div",I,[a.value?(o(),n(w,{key:1},[e("div",P,[e("div",E,[e("div",U,[t[2]||(t[2]=e("h2",{class:"mb-0"},"Éditer un article",-1)),h(V)])])]),e("div",$,[e("div",j,[r.value?(o(),n("div",D,[t[3]||(t[3]=e("i",{class:"bi bi-exclamation-triangle-fill me-2"},null,-1)),m(v(r.value),1)])):p("",!0),e("div",M,[t[12]||(t[12]=e("div",{class:"card-header"},[e("h5",{class:"card-title mb-0"},"Informations de l'article")],-1)),e("div",R,[a.value.produit?(o(),n("div",q,[t[4]||(t[4]=e("label",{class:"form-label"},"Produit",-1)),e("p",B,v(a.value.produit),1),t[5]||(t[5]=e("small",{class:"form-text text-muted"},"Modifiable dans la fiche produit",-1))])):p("",!0),a.value.description!=null?(o(),n("div",C,[t[6]||(t[6]=e("label",{class:"form-label"},"Description",-1)),e("p",F,v(a.value.description||"-"),1)])):p("",!0),e("form",{onSubmit:k(g,["prevent"])},[e("input",{type:"hidden",name:"_csrf",value:f.value},null,8,L),e("div",O,[t[8]||(t[8]=e("label",{for:"prix",class:"form-label"},[m("Prix "),e("span",{class:"text-danger"},"*")],-1)),e("div",z,[b(e("input",{id:"prix","onUpdate:modelValue":t[0]||(t[0]=i=>l.value.prix=i),type:"number",step:"0.01",class:"form-control",required:"",placeholder:"0.00"},null,512),[[_,l.value.prix,void 0,{number:!0}]]),t[7]||(t[7]=e("span",{class:"input-group-text"},"€",-1))])]),e("div",K,[t[9]||(t[9]=e("label",{for:"unite",class:"form-label"},[m("Qté mini "),e("span",{class:"text-danger"},"*")],-1)),b(e("input",{id:"unite","onUpdate:modelValue":t[1]||(t[1]=i=>l.value.unite=i),type:"text",class:"form-control",required:"",placeholder:"1"},null,512),[[_,l.value.unite]]),t[10]||(t[10]=e("div",{class:"form-text"},"Unité ou quantité minimale commandable",-1))]),e("div",Q,[e("button",{type:"submit",class:"btn btn-success",disabled:c.value},[c.value?(o(),n("span",H)):p("",!0),t[11]||(t[11]=m(" Enregistrer les modifications ",-1))],8,G),e("a",{href:`/admin/catalogues/${d.value}/edit`,class:"btn btn-secondary"},"Annuler",8,J)])],32)])]),e("div",W,[e("a",{href:`/admin/catalogues/${d.value}/edit`,class:"btn btn-outline-secondary"}," Retour à l'édition du catalogue ",8,X),t[13]||(t[13]=e("a",{href:"/admin/catalogues/vue",class:"btn btn-outline-secondary"}," Retour à la liste des catalogues ",-1))])])])],64)):(o(),n("div",N,"Article non trouvé."))]))}},x=S(Y);x.use(T());x.mount("#admin-article-edit-app");
