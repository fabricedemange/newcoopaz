import{o as u,c,a as s,b as f,t as y,d as b,w as g,e as m,v as p,r,g as _,h as T}from"./chunks/runtime-dom.esm-bundler-CYnru-If.js";const S={class:"container mt-5"},V={class:"row justify-content-center"},N={class:"col-md-6"},h={key:0,class:"alert alert-danger"},k=["value"],x={class:"mb-3"},E={class:"mb-3"},U={class:"mb-3"},j={class:"d-grid gap-2"},q=["disabled"],A={key:0,class:"spinner-border spinner-border-sm me-1"},B={__name:"RegisterPage",setup(D){const n=r(""),l=r(""),i=r(""),a=r(""),o=r(!1),v=_(()=>window.CSRF_TOKEN||"");async function w(){a.value="",o.value=!0;try{const d=new URLSearchParams({username:n.value,email:l.value,password:i.value,_csrf:v.value}),t=await(await fetch("/register",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},body:d.toString(),credentials:"include"})).json().catch(()=>({}));if(t.success&&t.redirect){window.location.href=t.redirect;return}a.value=t.error||"Une erreur est survenue."}catch{a.value="Erreur de connexion. Veuillez réessayer."}finally{o.value=!1}}return(d,e)=>(u(),c("div",S,[s("div",V,[s("div",N,[e[8]||(e[8]=s("h2",null,"Inscription",-1)),e[9]||(e[9]=s("div",{class:"alert alert-warning"},[s("strong",null,"⚠️ ATTENTION :"),f(" Votre inscription ne sera définitive qu'une fois validée par un administrateur ! ")],-1)),a.value?(u(),c("div",h,y(a.value),1)):b("",!0),s("form",{onSubmit:g(w,["prevent"])},[s("input",{type:"hidden",name:"_csrf",value:v.value},null,8,k),s("div",x,[e[3]||(e[3]=s("label",{for:"username",class:"form-label"},"Nom d'utilisateur",-1)),m(s("input",{id:"username","onUpdate:modelValue":e[0]||(e[0]=t=>n.value=t),type:"text",class:"form-control",required:"",autofocus:""},null,512),[[p,n.value]])]),s("div",E,[e[4]||(e[4]=s("label",{for:"email",class:"form-label"},"Email",-1)),m(s("input",{id:"email","onUpdate:modelValue":e[1]||(e[1]=t=>l.value=t),type:"email",class:"form-control",required:""},null,512),[[p,l.value]])]),s("div",U,[e[5]||(e[5]=s("label",{for:"password",class:"form-label"},"Mot de passe",-1)),m(s("input",{id:"password","onUpdate:modelValue":e[2]||(e[2]=t=>i.value=t),type:"password",class:"form-control",required:""},null,512),[[p,i.value]])]),s("div",j,[s("button",{type:"submit",class:"btn btn-success",disabled:o.value},[o.value?(u(),c("span",A)):b("",!0),e[6]||(e[6]=f(" S'inscrire ",-1))],8,q),e[7]||(e[7]=s("a",{href:"/login",class:"btn btn-link"},"Déjà inscrit ? Se connecter",-1))])],32)])])]))}},C=T(B);C.mount("#auth-register-app");
